<div class="container-fluid">
  <%= render 'search/search_form' %>
  <%= render 'search/search_input' %>
  <%= render 'events/details_modal' %>
  <div class="row">
    <div class="col-lg-6 col-sm-12">
      <%= render 'search/results_map' %>
    </div>
    <div class="col-lg-6 col-sm-12">
      <%= render 'events/events_grid' %>
    </div>
  </div>

</div>

<script type="text/javascript">

  // Start by hiding the searchForm
  $(document.getElementById('searchForm')).toggle();

  $('#eventDetailsModal').on('show.bs.modal', function(event) {
    var modal = $(this);
    var target = $(event.relatedTarget);
    var json;
    if(target.context) { // Grid clicked
      var dataset = target.context.dataset;
      json = JSON.parse(dataset.json);
    } else { // Marker clicked
      json = modal[0].json;
    }
    modal.find('.modal-title').text(json.name);
    if( json.venue ) {
      modal.find('#venueName').text(json.venue.name);
    }
    if( json.group ) {
      modal.find('#groupName').text(json.group.name);
    }

    modal.find('#eventTime').text(json.time);
    modal.find('#eventDescription').text(json.description);
    modal.find('#moreInfo').attr("href", json.link);
  })

</script>
